# tg_wiki

Телеграм-бот на **aiogram**, который показывает случайные статьи из **Википедии** и умеет искать статьи по запросу.  

## Возможности

- `/next` — случайная статья (с превью-картинкой, если она есть).
- `/search <запрос>` — поиск по названию и по тексту.
- Кнопки:
  - **Следующий пост** — получить следующую случайную статью.
  - Выбор результата поиска — открыть статью.
  - Навигация **❮ / ❯** — листать текст по страницам.
- `/cancel` — сброс состояния (FSM).
- `/start`, `/help` — базовые команды.

## Требования

- Python **3.12+**
- Токен Telegram Bot API (через `@BotFather`)

## Установка

### 1) Клонирование и виртуальное окружение

```bash
git clone <repo_url>
cd tg_wiki

python3 -m venv .venv
source .venv/bin/activate
```

### 2) Установка зависимостей

Рекомендуемый способ — установить пакет в editable-режиме:

```bash
pip install -e .
```

## Конфигурация

Создайте файл `.env` в корне проекта:

```env
BOT_TOKEN=123456789:AA...your_token...
```

Можно также передавать токен через переменную окружения `BOT_TOKEN`.

## Запуск

```bash
tg-wiki
```

## Команды бота

- `/start` — стартовое сообщение.
- `/help` — справка.
- `/next` — следующая (случайная) статья.
- `/search <запрос>` — поиск по названию или ключевым словам.
  - Если запустить `/search` без аргумента — бот попросит ввести запрос (FSM).
  - Также поддерживается поиск по **цитате** (quote/reply): `/search` → ответить на сообщение/цитату.
- `/cancel` — отмена текущего действия и сброс состояния.

## Troubleshooting

### Не подключается к Telegram API (`Cannot connect to host api.telegram.org:443`)

Проверьте доступ к Telegram из текущей сети:

```bash
getent hosts api.telegram.org
curl -I https://api.telegram.org
curl "https://api.telegram.org/bot<ТОКЕН>/getMe"
```

Если `curl` тоже не работает — проблема в сети.

## Лицензия

MIT. См. файл `LICENSE`.
